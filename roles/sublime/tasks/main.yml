---
- name: install gpg key
  apt_key:
    url: "https://download.sublimetext.com/sublimehq-pub.gpg"
    state: present

- name: add sublime text ppa
  apt_repository:
    repo: 'deb https://download.sublimetext.com/ apt/stable/'
    filename: sublime-text
    state: present

- name: update cache
  shell: apt-get update

- name: install sublime text
  apt: name="sublime-text" state=latest

- name: create configuration directory
  file:
    path:  "{{ sublime_config_dir }}"
    state: directory
    owner: "{{ my_user }}"
    group: "{{ my_group }}"
    mode:  0755
    recurse: yes

- name: add custom configuration
  template:
    src: Preferences.sublime-settings
    dest: "{{ sublime_config_dir }}/Preferences.sublime-settings"
    owner: "{{ my_user }}"
    group: "{{ my_group }}"
    mode: 0664
